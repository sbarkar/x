{"ast":null,"code":"import _defineProperty from \"/Users/sbarkar/Documents/projects/x/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/sbarkar/Documents/projects/x/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/sbarkar/Documents/projects/x/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport styles from '@/styles/Programs/Winamp.module.scss';\nimport { appendElement, focusOnDrag, focusResizableElementRef } from '@/utils/elements';\nimport { closeEqualizer, loadTrackOrSkin, touchControls, webampOptions } from '@/utils/winamp';\nimport { onTouchEventsOnly } from '@/utils/events';\nimport { Rnd } from 'react-rnd';\nimport { useEffect, useRef, useState } from 'react';\nvar defaultDimensions = {\n  height: 232,\n  width: 275\n};\n\nvar getWebamp = function getWebamp() {\n  return document.getElementById('webamp');\n};\n\nvar Winamp = function Winamp(_ref) {\n  var onBlur = _ref.onBlur,\n      onClose = _ref.onClose,\n      onMinimize = _ref.onMinimize,\n      onFocus = _ref.onFocus,\n      onDrag = _ref.onDrag,\n      zIndex = _ref.zIndex,\n      appUrl = _ref.url,\n      _ref$file = _ref.file;\n  _ref$file = _ref$file === void 0 ? {} : _ref$file;\n  var _ref$file$url = _ref$file.url,\n      url = _ref$file$url === void 0 ? '' : _ref$file$url,\n      _ref$file$name = _ref$file.name,\n      name = _ref$file$name === void 0 ? '' : _ref$file$name;\n\n  var _useState = useState(),\n      webampLib = _useState[0],\n      setWebampLib = _useState[1];\n\n  var _useState2 = useState(false),\n      closing = _useState2[0],\n      setClosing = _useState2[1];\n\n  var elementRef = useRef(null);\n  var dragContainerRef = useRef(null);\n\n  var loadWebamp = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$import, WebampConstructor, webamp, _ref3, containerElement;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return import('webamp');\n\n            case 2:\n              _yield$import = _context.sent;\n              WebampConstructor = _yield$import[\"default\"];\n              webamp = new WebampConstructor(webampOptions);\n              _ref3 = elementRef, containerElement = _ref3.current;\n              webamp.onWillClose(function () {\n                return setClosing(true);\n              });\n              if (onMinimize) webamp.onMinimize(onMinimize);\n              closeEqualizer(webamp);\n              _context.next = 11;\n              return webamp.renderWhenReady(containerElement);\n\n            case 11:\n              appendElement(containerElement, getWebamp());\n              focusResizableElementRef(dragContainerRef);\n              loadTrackOrSkin(webamp, url, name);\n              return _context.abrupt(\"return\", webamp);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function loadWebamp() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    var tryDispose = function tryDispose() {\n      try {\n        webampLib === null || webampLib === void 0 ? void 0 : webampLib.dispose();\n      } catch (_exception) {\n        /* eslint no-empty: off */\n      }\n    };\n\n    loadWebamp().then(function (loadedWebamp) {\n      setWebampLib(loadedWebamp);\n    });\n    return tryDispose;\n  }, []);\n  useEffect(function () {\n    if (closing) {\n      setClosing(false);\n      onClose();\n    }\n  }, [closing, onClose]);\n  useEffect(function () {\n    if (appUrl && webampLib) {\n      loadTrackOrSkin(webampLib, appUrl, name);\n    }\n  }, [appUrl, webampLib]);\n  return /*#__PURE__*/_jsx(Rnd, {\n    className: styles.winamp,\n    cancel: touchControls,\n    dragHandleClassName: \"draggable\",\n    enableResizing: false,\n    enableUserSelectHack: false,\n    onBlur: onBlur,\n    onDrag: onTouchEventsOnly,\n    onDragStart: focusOnDrag,\n    onDragStop: onDrag,\n    onFocus: onFocus,\n    style: {\n      zIndex: zIndex\n    },\n    ref: dragContainerRef,\n    tabIndex: -1,\n    children: /*#__PURE__*/_jsx(\"article\", {\n      ref: elementRef\n    })\n  });\n};\n\nexport default Winamp;\nexport var loaderOptions = _objectSpread({\n  windowed: false\n}, defaultDimensions);","map":null,"metadata":{},"sourceType":"module"}